<div class="flex-column mt-3" id="entity-div" style="display: none;">
    <div class="alert alert-warning alert-dismissible show" role="alert">
        <strong><i class="bi bi-box"></i>&nbsp;&nbsp;Entidades</strong><small> : requer permissão
            [<strong>entity-create</strong>]</small>
        <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
    </div>
    <div id="entity-div-form">
        <form class="form-group" id="entity-div-form-group">
            <div class="mb-4" id="entity-input-name">
                <label for="entity-input-text-name" class="label text-secondary"><i
                        class="bi bi-box"></i>&nbsp;Nome</label>
                <input type="text" class="form-control" id="entity-name" value="Pessoa"
                    placeholder="// #issue: pesquisar no banco entidade com mesmo nome a partir do terceiro caracter digitado">
            </div>
            <div class="mb-4 " style="display: none;" id="entity-input-namespace">
                <label for="entity-namespace" class="label text-secondary"><i class="bi bi-tags"></i>&nbsp;Namespace
                    <small>nomes dos campos separadas por
                        virgulas</small></label>
                <textarea class="form-control" style="height: 5rem;" id="entity-namespace"
                    placeholder="// #issue: analisar o namespace de todo sistema">
pessoaId, nome, email, celular, senha, crdate, isactive
                </textarea>
            </div>
            <div class="mb-4" style="display: none;" id="entity-input-fields">
                <label for="entity-fields" class="label text-secondary"><i class="bi bi-server"></i>&nbsp;Campos</label>
                <div class="table-responsive border-top">
                    <table class="table table-striped table-hover">
                        <thead>
                            <th>Campo</th>
                            <th>Tipo</th>
                            <th>Tamanho</th>
                            <th>Aceita null</th>
                            <th>Valor inicial</th>
                            <th>Permite pesquisa</th>
                            <th>Sensibilidade&nbsp;<i class="bi bi-shield-lock"></i></th>
                        </thead>
                        <tbody id="entity-fields-tbody"></tbody>
                    </table>
                </div>
            </div>
            <div class="mb-4 entity-input-form" style="display: none;" id="entity-input-fields-form">
                <label for="entity-name" class="label text-secondary"><i
                        class="bi bi-ui-checks"></i>&nbsp;Formulário</label>
                <div class="table-responsive border-top">
                    <table class="table table-striped table-hover">
                        <thead>
                            <th>Campo</th>
                            <th>Label</th>
                            <th>Tipo</th>
                            <th>Valor Inicial</th>
                            <th>Obrigatório</th>
                            <th>Placeholder</th>
                            <th>Formatador</th>
                            <!-- #issue: implantar para ser AAA -->
                            <!-- https://ceweb.br/cartilhas/cartilha-w3cbr-acessibilidade-web-fasciculo-IV/ -->
                            <th>wcag&nbsp;<i class="bi bi-emoji-smile"></i></th>
                        </thead>
                        <tbody id="entity-fields-form-tbody"></tbody>
                    </table>
                    <div class="d-grid gap-2" id="entity-btn-create" style="display: none;">
                        <button class="btn btn-success" type="button"><i class="bi bi-box"></i>&nbsp;&nbsp;Criar entidade</button>
                    </div>
                </div>
            </div>
        </form>
    </div>
</div>
<script>

    (() => {

        let btn = document.getElementById('entity-btn-add')
        btn.addEventListener('click', (event) => {

            event.preventDefault()

            let div = document.getElementById('entity-div')
                , divForm = document.getElementById('entity-div-form')
                , formGroup = document.getElementById('entity-div-form-group')
                , inputName = document.getElementById('entity-input-name')
                , name = document.getElementById('entity-name')
                , inputNamespace = document.getElementById('entity-input-namespace')
                , namespace = document.getElementById('entity-namespace')
                , fields = document.getElementById('entity-input-fields')
                , form = document.getElementById('entity-input-fields-form')
                , tbodyFields = document.getElementById('entity-fields-tbody')
                , tbodyForm = document.getElementById('entity-fields-form-tbody')
                , btnCreate = document.getElementById('entity-btn-create')
                , tbodyFieldsHtml = ''
                , tbodyFormHtml = ''
                , enter
                , nameIsValid
                , namespaceIsValid

            div.style.display = 'block'
            name.focus()
            inputName.style.display = 'block'
            name.addEventListener('keypress', (event) => {

                event.preventDefault()
                enter = event.charCode === 13

                if (enter) {

                    // #issue: pesquisar no banco entidade com mesmo nome a partir do terceiro caracter digitado
                    nameIsValid = name.value.length >= 3

                    if (nameIsValid) {

                        inputNamespace.style.display = 'block'
                        namespace.focus()
                        namespace.addEventListener('keypress', (event) => {

                            event.preventDefault()
                            enter = event.charCode === 13

                            if (enter) {

                                // #issue: analisar o namespace de todo sistema
                                namespaceIsValid = namespace.value.length >= 3

                                if (namespaceIsValid) {

                                    fields.style.display = 'block'
                                    form.style.display = 'block'

                                    try {

                                        arrNamespace = namespace.value.split(',')

                                        for (i = 0; i < arrNamespace.length; i++) {
                                            tbodyFieldsHtml += `<tr><td>${arrNamespace[i].trim().toLowerCase()}</td><td colspan="6" class="text-center"><i class="bi bi-gear"></i> : trazer as possibilidade</td></tr>`
                                            tbodyFormHtml += `<tr><td>${arrNamespace[i].trim().toLowerCase()}</td><td colspan="7" class="text-center"><i class="bi bi-gear"></i> : trazer as possibilidade</td></tr>`
                                        }

                                        tbodyFields.innerHTML = tbodyFieldsHtml
                                        tbodyForm.innerHTML = tbodyFormHtml
                                        btnCreate.style.display = 'block'

                                    } catch (err) {

                                        alert('Erro', erro, 'danger')

                                    }
                                }
                            }
                        })
                    }
                }
            }
            )
        })

    })()

</script>